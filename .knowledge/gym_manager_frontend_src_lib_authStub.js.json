{"is_source_file": true, "format": "JavaScript", "description": "A set of minimal stub utilities for authentication, designed for local development without a backend, mimicking Supabase auth functions. It manages in-memory and localStorage state, providing functions for sign-in, sign-out, session retrieval, role management, and an event system for auth state changes.", "external_files": [], "external_methods": [], "published": ["getStorageKey", "getRoleMapKey", "getCurrentSession", "setCurrentSession", "clearAuthStorage", "ensureStubAuthInRedux", "getCurrentRole", "setRoleForEmail", "getRoleForEmail", "buildUserFromSession", "buildSessionPayload", "onAuthStateChange", "signIn", "signOut", "getUser", "supabaseAuthStub"], "classes": [], "methods": [{"name": "getStorageKey()", "description": "Returns the localStorage key used to persist the current session.", "scope": "", "scopeKind": ""}, {"name": "getRoleMapKey()", "description": "Returns the localStorage key used to persist an email->role map.", "scope": "", "scopeKind": ""}, {"name": "getCurrentSession()", "description": "Returns the current stub session from localStorage, or null if not set.", "scope": "", "scopeKind": ""}, {"name": "setCurrentSession(session)", "description": "Persists the provided session object to localStorage.", "scope": "", "scopeKind": ""}, {"name": "clearAuthStorage()", "description": "Clears the stub session and related mappings from localStorage.", "scope": "", "scopeKind": ""}, {"name": "ensureStubAuthInRedux(seedFn)", "description": "Ensures Redux gets a seed user when none exists, setting a default if needed.", "scope": "", "scopeKind": ""}, {"name": "getCurrentRole()", "description": "Returns the current role from the stored session.", "scope": "", "scopeKind": ""}, {"name": "setRoleForEmail(email, role)", "description": "Persist a role mapping for a specific email.", "scope": "", "scopeKind": ""}, {"name": "getRoleForEmail(email)", "description": "Lookup a role for a given email from the local role map; special-case owner emails.", "scope": "", "scopeKind": ""}, {"name": "buildUserFromSession(s)", "description": "Constructs a user object from a session object.", "scope": "", "scopeKind": ""}, {"name": "buildSessionPayload(s)", "description": "Builds a session payload compatible with Supabase from a session object.", "scope": "", "scopeKind": ""}, {"name": "onAuthStateChange(callback)", "description": "Registers a callback for auth state changes, immediately invoked with current session if present.", "scope": "", "scopeKind": ""}, {"name": "signIn(email, password)", "description": "Emulates sign-in, deriving role from email and storing session state.", "scope": "", "scopeKind": ""}, {"name": "signOut()", "description": "Emulates sign-out by clearing local session.", "scope": "", "scopeKind": ""}, {"name": "getUser()", "description": "Returns the current user object from stored session.", "scope": "", "scopeKind": ""}, {"name": "supabaseAuthStub", "description": "A minimal stub mimicking the main methods of a Supabase auth client, including session management and event subscription."}, {"name": "getSession()", "scope": "supabaseAuthStub", "scopeKind": "class", "description": "unavailable"}, {"name": "notifyAuthListeners(event, payload)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "readRoleMap()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "signInWithPassword({ email, password })", "scope": "supabaseAuthStub", "scopeKind": "class", "description": "unavailable"}, {"name": "signUp({ email, password, options })", "scope": "supabaseAuthStub", "scopeKind": "class", "description": "unavailable"}, {"name": "writeRoleMap(map)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["localStorage.getItem", "localStorage.setItem", "localStorage.removeItem", "JSON.parse", "JSON.stringify", "notifyAuthListeners", "getCurrentSession", "setCurrentSession"], "search-terms": ["auth stub", "local development", "supabase compatible", "mock auth", "in-memory auth", "localStorage session"], "state": 2, "file_id": 70, "knowledge_revision": 207, "git_revision": "", "revision_history": [{"205": ""}, {"207": ""}], "ctags": [{"_type": "tag", "name": "authListeners", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^const authListeners = new Set();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildSessionPayload", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^function buildSessionPayload(s) {$/", "language": "JavaScript", "kind": "function", "signature": "(s)"}, {"_type": "tag", "name": "buildUserFromSession", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^function buildUserFromSession(s) {$/", "language": "JavaScript", "kind": "function", "signature": "(s)"}, {"_type": "tag", "name": "clearAuthStorage", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export function clearAuthStorage() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  const fallback = { email: 'member@example.com', role: 'member', name: 'Local Member' };$/", "language": "JavaScript", "kind": "property", "scope": "ensureStubAuthInRedux.fallback", "scopeKind": "class"}, {"_type": "tag", "name": "ensureStubAuthInRedux", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export function ensureStubAuthInRedux(seedFn) {$/", "language": "JavaScript", "kind": "function", "signature": "(seedFn)"}, {"_type": "tag", "name": "fallback", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  const fallback = { email: 'member@example.com', role: 'member', name: 'Local Member' };$/", "language": "JavaScript", "kind": "class", "scope": "ensureStubAuthInRedux", "scopeKind": "class"}, {"_type": "tag", "name": "getCurrentRole", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export function getCurrentRole() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getCurrentSession", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export function getCurrentSession() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getRoleForEmail", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export function getRoleForEmail(email) {$/", "language": "JavaScript", "kind": "function", "signature": "(email)"}, {"_type": "tag", "name": "getRoleMapKey", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export function getRoleMapKey() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getSession", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  async getSession() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "supabaseAuthStub", "scopeKind": "class"}, {"_type": "tag", "name": "getStorageKey", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export function getStorageKey() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getUser", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  async getUser() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "supabaseAuthStub", "scopeKind": "class"}, {"_type": "tag", "name": "getUser", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export async function getUser() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  const user = { id: 'stub-user', name, email, role };$/", "language": "JavaScript", "kind": "property", "scope": "signIn.user", "scopeKind": "class"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  const fallback = { email: 'member@example.com', role: 'member', name: 'Local Member' };$/", "language": "JavaScript", "kind": "property", "scope": "ensureStubAuthInRedux.fallback", "scopeKind": "class"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  const user = { id: 'stub-user', name, email, role };$/", "language": "JavaScript", "kind": "field", "scope": "signIn.user", "scopeKind": "class"}, {"_type": "tag", "name": "notifyAuthListeners", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^function notifyAuthListeners(event, payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(event, payload)"}, {"_type": "tag", "name": "onAuthStateChange", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  onAuthStateChange: (cb) => onAuthStateChange((event, payload) => cb?.(event, payload)),$/", "language": "JavaScript", "kind": "property", "scope": "supabaseAuthStub", "scopeKind": "class"}, {"_type": "tag", "name": "onAuthStateChange", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export function onAuthStateChange(callback) {$/", "language": "JavaScript", "kind": "function", "signature": "(callback)"}, {"_type": "tag", "name": "readRoleMap", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^function readRoleMap() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  const fallback = { email: 'member@example.com', role: 'member', name: 'Local Member' };$/", "language": "JavaScript", "kind": "property", "scope": "ensureStubAuthInRedux.fallback", "scopeKind": "class"}, {"_type": "tag", "name": "setCurrentSession", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export function setCurrentSession(session) {$/", "language": "JavaScript", "kind": "function", "signature": "(session)"}, {"_type": "tag", "name": "setRoleForEmail", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export function setRoleForEmail(email, role) {$/", "language": "JavaScript", "kind": "function", "signature": "(email, role)"}, {"_type": "tag", "name": "signIn", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export async function signIn(email, password) {$/", "language": "JavaScript", "kind": "function", "signature": "(email, password)"}, {"_type": "tag", "name": "signInWithPassword", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  async signInWithPassword({ email, password }) {$/", "language": "JavaScript", "kind": "method", "signature": "({ email, password })", "scope": "supabaseAuthStub", "scopeKind": "class"}, {"_type": "tag", "name": "signOut", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  async signOut() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "supabaseAuthStub", "scopeKind": "class"}, {"_type": "tag", "name": "signOut", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export async function signOut() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "signUp", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  async signUp({ email, password, options }) {$/", "language": "JavaScript", "kind": "method", "signature": "({ email, password, options })", "scope": "supabaseAuthStub", "scopeKind": "class"}, {"_type": "tag", "name": "supabaseAuthStub", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^export const supabaseAuthStub = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^  const user = { id: 'stub-user', name, email, role };$/", "language": "JavaScript", "kind": "class", "scope": "signIn", "scopeKind": "class"}, {"_type": "tag", "name": "writeRoleMap", "path": "/home/kavia/workspace/code-generation/gym-management-system-21100-21109/gym_manager_frontend/src/lib/authStub.js", "pattern": "/^function writeRoleMap(map) {$/", "language": "JavaScript", "kind": "function", "signature": "(map)"}], "hash": "7fd3b610c60331f5f43a9d8e4241764c", "format-version": 4, "code-base-name": "gym_manager_frontend", "filename": "gym_manager_frontend/src/lib/authStub.js", "fields": [{"name": "const fallback = { email: 'member@example.com', role: 'member', name: 'Local Member' };", "scope": "ensureStubAuthInRedux.fallback", "scopeKind": "class", "description": "unavailable"}, {"name": "const user = { id: 'stub-user', name, email, role };", "scope": "signIn.user", "scopeKind": "class", "description": "unavailable"}, {"name": "onAuthStateChange: (cb) => onAuthStateChange((event, payload) => cb?.(event, payload)),", "scope": "supabaseAuthStub", "scopeKind": "class", "description": "unavailable"}]}